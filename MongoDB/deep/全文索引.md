
## 全文索引

创建

```
db.col.ensureIndex({name:"text"})
```

使用索引搜索关键字
```
db.col.find({$text:{$search:"Tom"}})
```

删除全文索引
```
db.col.getIndexes() // 先获取索引名

db.col.dropIndex("name_text")

```

### 使用正则表达式通过关键字查找

```
db.col.find({name:{$regex:"Thorin"}})

等同于

db.col.find({name:/Thorin/})
```

* 不区分大小写的正则表达式： 设置`$options:"$i"`

```
db.col.find({name:{$regex:"Thorin",$options:"$i"}})
db.col.find({name:/Thorin/i})
```

###### 数组元素也可以使用正则

```
db.col.find({tags:{$regex:"Th"}}) // 包含th的， 也可以`^Th`表示开头
```

如果正则中使用变量，用`eval`
```
var name = eval("/" + 变量值key + "/i");

eg:
db.col.find({title:eval("/" + title + "/i")})

db.col.find({title:{$regex:title,$option:"$i"}})
```

* i 忽略大小写

* m 多行匹配

* x 忽略非转义的空白字符

* s 单行匹配模式

