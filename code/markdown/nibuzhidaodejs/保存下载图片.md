
## 调用浏览器自带的下载

```
var $a = document.createElement('a')
$a.setAttribute('href', this.url)
$a.setAttribute('download', '')
var evObj = document.createEvent('MouseEvents')
evObj.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, true, false, 0, null)
$a.dispatchEvent(evObj)
```


## a标签

```
      var canvas = document.getElementById('canvas')
      var ctx = canvas.getContext('2d')
      var image = new Image()
      image.crossOrigin = '*'
      image.onload = function () {
        ctx.drawImage(image, 0, 0)
        let url = canvas.toDataURL('image/png')
        var a = document.createElement('a')
        var event = new MouseEvent('click')
        a.download = name || '下载图片名称'
        a.href = url
        a.dispatchEvent(event)
      }
      image.src = this.url

```

或

```
      var canvas = document.getElementById('canvas')
      var ctx = canvas.getContext('2d')
      var image = new Image()
      image.crossOrigin = '*'
      image.onload = function () {
        ctx.drawImage(image, 0, 0)
        let url = canvas.toDataURL('image/png').replace('image/png', 'image/octet-stream')

        window.location.href = url
      }
      image.src = this.info.icode
```


html2canvas

```
import html2canvas from 'html2canvas'

      html2canvas(document.querySelector('.share-body')).then(function(canvas) {
        document.body.appendChild(canvas)
      })
```

下载base64图片
```
    saveImg (fileName, img) {
      let aLink = document.createElement('a')
      let blob = this.base64ToBlob(img)
      let evt = document.createEvent('HTMLEvents')
      evt.initEvent('click', true, true)
      aLink.download = 'code.png'
      aLink.href = URL.createObjectURL(blob)
      aLink.click()
    },
    base64ToBlob (code) {
      let parts = code.split(';base64,')
      let contentType = parts[0].split(':')[1]
      let raw = window.atob(parts[1])
      let rawLength = raw.length
      let uInt8Array = new Uint8Array(rawLength)
      for (let i = 0; i < rawLength; ++i) {
        uInt8Array[i] = raw.charCodeAt(i)
      }
      return new Blob([uInt8Array], {type: contentType})
    }
```



